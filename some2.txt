using System;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;

[ComImport]
[Guid("0000000B-0000-0000-C000-000000000046")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IStorage
{
    void CreateStream(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        uint grfMode,
        uint reserved1,
        uint reserved2,
        out IStream ppstm);

    void OpenStream(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        IntPtr reserved1,
        uint grfMode,
        uint reserved2,
        out IStream ppstm);

    void CreateStorage(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        uint grfMode,
        uint reserved1,
        uint reserved2,
        out IStorage ppstg);

    void OpenStorage(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        IStorage pstgPriority,
        uint grfMode,
        IntPtr snbExclude,
        uint reserved,
        out IStorage ppstg);

    void CopyTo(
        uint ciidExclude,
        [MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 0)]
        Guid[] rgiidExclude,
        IntPtr snbExclude,
        IStorage pstgDest);

    void MoveElementTo(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        IStorage pstgDest,
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsNewName,
        uint grfFlags);

    void Commit(uint grfCommitFlags);

    void Revert();

    void EnumElements(
        uint reserved1,
        IntPtr reserved2,
        uint reserved3,
        out object ppenum);

    void DestroyElement(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName);

    void RenameElement(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsOldName,
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsNewName);

    void SetElementTimes(
        [MarshalAs(UnmanagedType.LPWStr)] string pwcsName,
        FILETIME pctime,
        FILETIME patime,
        FILETIME pmtime);

    void SetClass(ref Guid clsid);

    void SetStateBits(uint grfStateBits, uint grfMask);

    void Stat(out STATSTG pstatstg, uint grfStatFlag);
}
