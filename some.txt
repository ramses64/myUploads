    uint allowed = pdwEffect;

    // If COPY is allowed, prefer COPY
    if ((allowed & Ole32.DROPEFFECT_COPY) != 0)
    {
        pdwEffect = Ole32.DROPEFFECT_COPY;
    }
    else if ((allowed & 2) != 0) // DROPEFFECT_MOVE
    {
        pdwEffect = 2;
    }
    else
    {
        pdwEffect = 0; // DROPEFFECT_NONE
        return;
    }