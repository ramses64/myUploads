private static Control? DeepHitTest(Control root, Point clientPt)
{
    // clientPt is in root's coordinate system
    Control? child = root.GetChildAtPoint(clientPt, GetChildAtPointSkip.Invisible);

    while (child != null)
    {
        // Convert point into the child's coordinate system
        clientPt = new Point(clientPt.X - child.Left, clientPt.Y - child.Top);

        var next = child.GetChildAtPoint(clientPt, GetChildAtPointSkip.Invisible);
        if (next == null) return child;

        child = next;
    }

    return root; // fallback: root control itself
}