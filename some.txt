var used = new HashSet<string>(StringComparer.OrdinalIgnoreCase);

for (int i = 0; i < fileNames.Count; i++)
{
    // If Outlook returns the same filename for all items, this makes them unique.
    string outPath = GetUniquePath(baseDir, fileNames[i], used);

    if (!TryGetFileContentsToPath(dataObj, cfFileContents, i, outPath))
        continue;

    outPaths.Add(outPath);
}