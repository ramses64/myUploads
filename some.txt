private const short CF_UNICODETEXT = 13; // Win32 clipboard constant

private static bool TryGetUnicodeText(
    System.Runtime.InteropServices.ComTypes.IDataObject dataObj,
    out string text)
{
    text = string.Empty;

    var fmt = new FORMATETC
    {
        cfFormat = CF_UNICODETEXT,
        dwAspect = DVASPECT.DVASPECT_CONTENT,
        lindex = -1,
        ptd = IntPtr.Zero,
        tymed = TYMED.TYMED_HGLOBAL
    };

    if (dataObj.QueryGetData(ref fmt) != 0)
        return false;

    dataObj.GetData(ref fmt, out STGMEDIUM medium);

    try
    {
        if (medium.tymed != TYMED.TYMED_HGLOBAL || medium.unionmember == IntPtr.Zero)
            return false;

        IntPtr p = Kernel32.GlobalLock(medium.unionmember);
        if (p == IntPtr.Zero)
            return false;

        try
        {
            // HGLOBAL contains a null-terminated UTF-16 string
            text = Marshal.PtrToStringUni(p) ?? string.Empty;
            return !string.IsNullOrWhiteSpace(text);
        }
        finally
        {
            Kernel32.GlobalUnlock(medium.unionmember);
        }
    }
    finally
    {
        OleHelpers.ReleaseStgMedium(ref medium);
    }
}